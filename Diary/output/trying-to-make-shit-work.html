<!DOCTYPE html>
<html lang="">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" 
          content="	Title: Trying to make shit work; 
	Date: 2016-03-16; 
	Author: Tibo
">
    <meta name="author" content="Tibo">

    <title>	Trying to make shit work â€” Thesis Log
</title>

    <!-- Bootstrap Core CSS, Code Highlighting -->
    <link href="/theme/css/bootstrap.min.css" rel="stylesheet">
    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/theme/css/theme.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <header class="clearfix"> 
        <section class="row">  	
            <h1 class="col-lg-8 col-lg-offset-2">
                <a href="" class="title-link">Thesis Log</a>
                <br>
                    <small class="subtitle"> Keeping myself in check</small>
            </h1>
        </section>

        <section class="row clearfix">
            <ul class="col-lg-8 col-lg-offset-2 list-unstyled">
                <li class="h5 pull-right">
                    <a href="/pages/cascade-vrft.html">Cascade VRFT</a>
                </li>
                <li class="h5 pull-right">
                    <a href="/pages/the-vrft-technique.html">The VRFT Technique</a>
                </li>
            </ul>
        </section>
    </header>

    <!-- Page Content -->
    <div class="container clearfix">

        <div class="row">
               
            <!-- Blog Post Content Column -->
            <div class="col-lg-8 col-lg-offset-2">
<article class="post" >
	<div class="post-header">
		<h2>Trying to make shit work</h2>

		<time datetime="2016-03-16T00:00:00+01:00" itemprop="datePublished">16 marzo 2016</time>
	</div>

	<div class="post-content">
		<p>Consider a simple case:</p>
<div class="math">
\begin{equation*}
C(z; \theta) = \frac{\theta_0 + \theta_1 z^{-1}}{1 - z^{-1}}
             = \frac{\theta_0}{1 - z^{-1}} + \frac{\theta_1 z^{-1}}{1 - z^{-1}}
\end{equation*}
</div>
<p>I would expect to write this as:</p>
<div class="highlight"><pre><span></span><span class="n">c1</span> <span class="p">=</span>    <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span>^<span class="o">-</span><span class="mi">1</span><span class="p">);</span>  <span class="n">c1</span><span class="p">.</span><span class="n">Variable</span> <span class="p">=</span> <span class="s">'z^-1'</span><span class="p">;</span>
<span class="n">c2</span> <span class="p">=</span> <span class="n">z</span>^<span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span>^<span class="o">-</span><span class="mi">1</span><span class="p">);</span>  <span class="n">c2</span><span class="p">.</span><span class="n">Variable</span> <span class="p">=</span> <span class="s">'z^-1'</span><span class="p">;</span>
<span class="n">Controller</span> <span class="p">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">;</span> <span class="n">c2</span><span class="p">];</span>
</pre></div>
<p>Then to calculate the optimal controller (<span class="math">\(C(z) = \beta^T(z) \cdot {\theta_n}^T\)</span>), assuming <span class="math">\(\underline{\theta} = \left| 1,1 \right|\)</span> I would write:</p>
<div class="highlight"><pre><span></span><span class="n">theta</span> <span class="p">=</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">OptimalController</span> <span class="p">=</span> <span class="n">Controller</span><span class="o">'</span> <span class="o">*</span> <span class="n">theta</span><span class="p">;</span>
</pre></div>
<p>The expected result is:</p>
<div class="math">
\begin{equation*}
\dfrac{1}{1 - z^{-1}} + \dfrac{z^{-1}}{1 - z^{-1}}
\end{equation*}
</div>
<p>Instead I get:</p>
<div class="math">
\begin{equation*}
\dfrac{1 - z^{-2}}{1 - 2 \cdot z^{-1} + z^{-2}} = \dfrac{-1 + z^{-2}}{\left( 1 - z^{-1} \right)^2}
\end{equation*}
</div>
<p>This happens because MATLAB is dumb. This is the process it follows:</p>
<div class="math">
\begin{equation*}
\begin{aligned}
    C(z; \theta) &amp;= \begin{bmatrix}
        \dfrac{-1}{1 - z^{-1}} \quad \dfrac{-z^{-1}}{1 - z^{-1}}
    \end{bmatrix} \
    \cdot \
    \begin{bmatrix} \
        1 \\
        1
    \end{bmatrix} \\
    &amp;= \dfrac{-z^{-1}}{1 - z^{-1}} + \dfrac{-1}{1 - z^{-1}} \\
    &amp;= \dfrac{-z^{-1} \left(1 - z^{-1} \right) - 1 \left(1 - z^{-1} \right)}{\left( 1 - z^{-1} \right)^2} \\
    &amp;= \dfrac{-1 + z^{-2}}{\left( 1 - z^{-1} \right)^2}
\end{aligned}
\end{equation*}
</div>
<p>Now things start to make sense:</p>
<div class="math">
\begin{equation*}
(1 - z^{-1})^6 = 1 - 6 \cdot z^{-1} + 15 \cdot z^{-2} - 20 \cdot z^{-3} + 15 \cdot z^{-4} -6 \cdot z^{-5} + \cdot z^{-6}
\end{equation*}
</div>
<p>Which is the <span class="math">\(z^{-4} \cdot Denominator\)</span>.</p>
<div class="section" id="weird-stuff">
<h2>Weird stuff:</h2>
<p>Why does</p>
<div class="highlight"><pre><span></span><span class="n">z</span> <span class="p">=</span> <span class="n">tf</span><span class="p">(</span><span class="s">'z'</span><span class="p">,</span> <span class="p">.</span><span class="mi">05</span><span class="p">);</span>
<span class="n">c</span> <span class="p">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span>^<span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
<p>Become <span class="math">\(\dfrac{-1}{1 - z^{-1}}\)</span> instead of <span class="math">\(\dfrac{1}{1 - z^{-1}}\)</span> ?</p>
<p>This happens because <tt class="docutils literal">Controller'</tt> return the <strong>conjugate transpose</strong> instead of the <strong>transpose</strong>. The transpose operation is actually <tt class="docutils literal">.'</tt>.</p>
</div>
<div class="section" id="questions-to-ask">
<h2>Questions to ask</h2>
<p>MATLAB doesn't do the smart sum of the parts of the controller which makes it harder to extract the parameter vector. We can only retrieve the raw controller. Using the example in the paper we can calculate a controller of the form <span class="math">\(\frac{p(z)}{\left(1 - z^{-1}\right)^6}\)</span> but what we really want is a controller of the form <span class="math">\(\frac{p^*(z)}{1 - z^{-1}}\)</span>.</p>
<p>How can we convert from one to the other? Do we need to bring the controller into canonical form ?</p>
<p>Since the <tt class="docutils literal">canon()</tt> and <tt class="docutils literal">minreal()</tt> forms are the same I'm not sure how to proceed.</p>
<p>I've tried it by identification by hand but the results don't seem to match so I'm not sure what to do from there ...</p>
<p>Also, in the paper, the Bode plots always refer to the control system. I assume that means the closed-loop control system. Am I right ?</p>
</div>
<div class="section" id="progress-today">
<h2>Progress today:</h2>
<p>I don't know shit.</p>
<p>I wanted to check that my script was correctly implementing VRFT. To do that I needed to validate that the outputs of the <tt class="docutils literal">VRFT1_dy</tt> function were the same as the solution provided by the paper. Since the forms of the controllers are different I had to write the identification problem by hand and solve it.</p>
<p>To validate that is worked I passed in the controller from the paper and check that is sat out the right parameters. I then passed in the OptimalController calculated by <tt class="docutils literal">VRFT1_dy</tt> and the parameters don't match ...</p>
<p>The bode plots of the system are also out of whack ...</p>
</div>
<div class="section" id="next-steps">
<h2>Next Steps:</h2>
<p>Go home, study discrete time systems and write a reference model by hand based on the requirements.</p>
<p>Once I can generate a controller with VRFT I can schedule a meeting with prof.</p>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' }, Macros: {} }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
	</div> 

</article>
            </div>
                
        </div><!-- /.row -->
        
    </div><!-- /.container -->

    <!-- Footer -->
    <footer>
    	<div class="row">
            <!-- Blog Sidebar Widgets Column -->
            <div class="col-md-2 col-md-offset-4 col-sm-4 col-sm-offset-2">
                <ul class="list-unstyled text-right">
                    <li> 
                        <a href="/pages/cascade-vrft.html">
                            Cascade VRFT
                        </a>
                    </li>
                    <li> 
                        <a href="/pages/the-vrft-technique.html">
                            The VRFT Technique
                        </a>
                    </li>
                </ul>
            </div>

            <div class="col-md-2 col-sm-4">
                <ul class="list-unstyled">
                    <li>                                 
                        <a href="/None" type="application/atom+xml">
                            <i class="fa-rss"></i>
                            Atom Posts Feed
                        </a>
                    </li>
                    <li>                                 
                        <a href="/" type="application/rss+xml">
                            <i class="fa-rss"></i>
                            RSS Posts Feed
                        </a>
                    </li>
                </ul>
            </div>
        </div>


        <div class="row">
            <div class="col-lg-12">
                <p class="text-center">
					Powered by <a href="http://blog.getpelican.com/">Pelican</a> 	
                </p>               
            </div>
        </div>
        <!-- /.row -->
    </footer>


    <!-- jQuery -->
    <script src="/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/theme/js/bootstrap.min.js"></script>

</body>

</html>