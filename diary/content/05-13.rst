
Still looking for mistakes
==========================


:date: 2016-05-13

Today I need to find out what is wrong with the inner controller vrft. 

What I know: 

- The size of the error in the inner controller is data-dependent. With a step response it becomes incredibly big
- The inner reference model compares very well to the actual system behaviour in simulink. They are the same (comparing :math:`q` from ct system with :math:`y_i`). The VRFT output is quite close but clearly not as good.
- The ct and dt variants of ``InnerRefeenceModel`` have the same dynamics.


..code-block:: matlab

    >> cloop = loopsens(PlantModel_dt, OptimalController); 
    >> zpk(cloop.Ti)

    ans =
     
      From input "du" to output "uC":
      3.1107 (z^2 - 2.001z + 1.001)
      -----------------------------
       (z+2.755) (z-1) (z-0.9986)
     
    Sample time: 0.01 seconds
    Discrete-time zero/pole/gain model. 

Considering that ``PlantModel_dt`` contains ``Mixer`` the presence of the unstable pole is worrying.
